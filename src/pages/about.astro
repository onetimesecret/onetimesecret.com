---
import Layout from "@/layouts/Layout.astro";
import { Plan } from "@/content/product/plans";
import type { PlanOptions } from "@/types/plan-options";
import "@/styles/global.css";
import "@/styles/tailwind.css";
import "@/fonts/font-face.css";

// Import the i18n utility
import { createI18nMessage } from "@/i18n/astro";
const { t } = createI18nMessage("en");

// Define page metadata
const pageTitle = "About | Onetime Secret";
const pageDescription =
  "Learn about Onetime Secret - a secure way to share sensitive information with self-destructing links.";

// Initialize plan data at build time
Plan.loadPlans();
const defaultPlan = Plan.getPlan("basic");
const anonymousPlan = Plan.getPlan("anonymous");

// Helper functions for converting units
const secondsToDays = (seconds: number) => {
  return seconds != null ? Math.floor(seconds / 86400) : 0;
};

const bytesToKB = (bytes: number) => {
  return bytes != null ? Math.round(bytes / 1024) : 0;
};

// Calculate values directly at build time (no reactivity needed)
const anonymousTtlDays = secondsToDays(
  anonymousPlan?.options?.ttl ?? 3600 * 24 * 7,
);
const anonymousSizeKB = bytesToKB(anonymousPlan?.options?.size ?? 102400);
const defaultTtlDays = secondsToDays(
  defaultPlan?.options?.ttl ?? 3600 * 24 * 14,
);
const defaultSizeKB = bytesToKB(defaultPlan?.options?.size ?? 1024000);

// HTML for links
const githubLink =
  '<a href="https://github.com/onetimesecret/onetimesecret">our code remains open-source</a>';
const privacyPolicyLink = `<a href="/info/privacy">privacy policy</a>`;
const openSourceLink =
  '<a href="https://github.com/onetimesecret/onetimesecret">open source</a>';
---

<Layout
  title={pageTitle}
  description={pageDescription}>
  <article class="prose dark:prose-invert md:prose-lg lg:prose-xl">
    <h2 class="">
      {t("web.about.title")}
    </h2>

    <p class="">
      {t("web.about.intro.paragraph1", { name: "Delano" })}
    </p>

    <p>
      {t("web.about.intro.paragraph2")}
    </p>

    <p set:html={t("web.about.intro.paragraph3", { githubLink })} />

    <p>
      {t("web.about.intro.paragraph4")}
    </p>

    <p class="">
      {t("web.about.intro.feedback_hint")}
    </p>

    <p class="">
      {t("web.about.intro.signature", { name: "Delano" })}
    </p>

    <p style="margin-left: 40%; margin-right: 40%">
      <a
        href="https://delanotes.com/"
        title={t("delano-mandelbaum")}>
        <img
          src="/src/assets/img/delano-g.png"
          width="95"
          height="120"
          border="0"
        />
      </a>
    </p>

    <h3>F.A.Q.</h3>

    <h4>{t("web.about.faq.why_use_title")}</h4>
    <p>
      {t("web.about.faq.why_use_description")}
    </p>

    <h4>{t("web.about.faq.file_limitation_title")}</h4>
    <p>
      {t("web.about.faq.file_limitation_description")}
    </p>

    <h4>{t("web.about.faq.text_copy_title")}</h4>
    <p>
      {t("web.about.faq.text_copy_description")}
    </p>

    <h4>{t("web.about.faq.secret_retrieval_title")}</h4>
    <p>{t("web.about.faq.secret_retrieval_description")}</p>

    {
      anonymousPlan && defaultPlan && (
        <>
          <h4>{t("web.about.faq.account_difference_title")}</h4>
          <p>
            {t("web.about.faq.account_difference_description", {
              anonymousTtlDays,
              anonymousSizeKB,
              defaultTtlDays,
              defaultSizeKB,
            })}
          </p>
        </>
      )
    }

    <h4>{t("web.about.faq.law_enforcement_title")}</h4>
    <p set:html={t("web.about.intro.paragraph3", { githubLink })} />
    <p
      set:html={t("web.about.faq.law_enforcement_description", {
        privacyPolicyLink,
      })}
    />

    <h4>{t("web.about.faq.trust_title")}</h4>
    <p>
      {t("web.about.faq.trust_description")}
    </p>
    <ul>
      <li>{t("web.about.faq.trust_points.0")}</li>
      <li>{t("web.about.faq.trust_points.1")}</li>
      <li set:html={t("web.about.faq.trust_points.2", { openSourceLink })} />
      <li>{t("web.about.faq.trust_points.3")}</li>
    </ul>

    <h4>{t("web.about.faq.passphrase_title")}</h4>
    <p>
      {t("web.about.faq.passphrase_description")}
    </p>
    <ul>
      <li>{t("web.about.faq.passphrase_points.0")}</li>
      <li>{t("web.about.faq.passphrase_points.1")}</li>
      <li>{t("web.about.faq.passphrase_points.2")}</li>
      <li>{t("web.about.faq.passphrase_points.3")}</li>
    </ul>
    <p>
      {t("web.about.faq.passphrase_final_note")}
    </p>
  </article>
</Layout>
