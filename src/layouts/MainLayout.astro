---
/**
 * MainLayout.astro
 * A standardized layout component that includes navigation, footer, and content
 * for consistent appearance across all pages
 */

// Component imports
import Layout from "@/layouts/Layout.astro";
import MainNavigation from "@/components/vue/layouts/MainNavigation.vue";
import type { MessageSchema } from "@/i18n";
import { DEFAULT_LANGUAGE, LANGUAGE_META } from "@config/astro/i18n";
import type { SupportedLanguage } from "@/i18n";

// Interface for props
export interface Props {
  title?: string;
  description?: string;
  canonicalUrl?: string;
  ogImage?: string;
  ogType?: string;
  twitterCard?: string;
  keywords?: string;
  noindex?: boolean;
  alternateLanguages?: { code: string; url: string }[];
  structuredData?: object;
  // Props for i18n
  htmlLang?: string;
  langDir?: string;
  initialMessages?: Record<string, MessageSchema>;
  // Determine if hero should be shown
  showHero?: boolean;
  heroTitle?: string;
  heroDescription?: string;
}

// Destructure props with defaults
const {
  title,
  description,
  canonicalUrl,
  ogImage,
  ogType,
  twitterCard,
  keywords,
  noindex,
  alternateLanguages,
  structuredData,
  htmlLang = DEFAULT_LANGUAGE,
  langDir,
  initialMessages,
  showHero = false,
  heroTitle,
  heroDescription,
} = Astro.props;

// Determine the effective language
const lang = htmlLang as SupportedLanguage;
const langMeta = LANGUAGE_META[lang];
---

<Layout
  title={title}
  description={description}
  canonicalUrl={canonicalUrl}
  ogImage={ogImage}
  ogType={ogType}
  twitterCard={twitterCard}
  keywords={keywords}
  noindex={noindex}
  alternateLanguages={alternateLanguages}
  structuredData={structuredData}
  htmlLang={htmlLang}
  langDir={langDir || langMeta.dir}
  initialMessages={initialMessages}
>
  <!-- Standard Header with Navigation -->
  <header
    class="sticky top-0 z-50 w-full border-b border-slate-200 bg-white/95 shadow-sm backdrop-blur-sm dark:border-slate-800 dark:bg-slate-900/90">
    <MainNavigation
      client:load
      locale={lang}
      initialMessages={initialMessages}
    />
  </header>

  <!-- Hero Section (Optional) -->
  {showHero && (
    <div
      class="relative overflow-hidden border-b border-slate-200/80 bg-gradient-to-b from-blue-50 to-white py-16 sm:py-24 dark:border-slate-800/50 dark:from-slate-800 dark:to-slate-900">
      <div
        class="pointer-events-none absolute inset-0 opacity-10 dark:opacity-5">
        <div
          class="bg-gradient-radial absolute top-0 right-0 h-1/3 w-1/3 transform from-blue-200 to-transparent blur-3xl">
        </div>
        <div
          class="bg-gradient-radial absolute bottom-0 left-0 h-1/3 w-1/3 transform from-blue-200 to-transparent blur-3xl">
        </div>
      </div>
      <div class="relative mx-auto max-w-7xl px-6 lg:px-8">
        <div class="mx-auto max-w-3xl lg:text-center">
          <div
            class="mb-6 inline-flex items-center justify-center rounded-full bg-blue-100 px-3 py-1.5 text-sm font-medium text-blue-600 ring-1 ring-blue-600/20 ring-inset dark:bg-blue-950 dark:text-blue-300 dark:ring-blue-800/30">
            <span class="mr-1.5">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="h-4 w-4">
                <path
                  fill-rule="evenodd"
                  d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </span>
            Onetime Secret
          </div>
          <h1
            class="bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-4xl font-bold tracking-tight text-slate-900 text-transparent sm:text-5xl md:text-6xl dark:from-white dark:to-slate-300 dark:text-white">
            {heroTitle}
          </h1>
          {heroDescription && (
            <p class="mx-auto mt-6 max-w-2xl text-lg leading-8 text-slate-600 dark:text-slate-300">
              {heroDescription}
            </p>
          )}
        </div>
      </div>
    </div>
  )}

  <!-- Main Content -->
  <main class="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
    <slot />
  </main>
</Layout>
